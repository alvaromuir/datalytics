// Generated by CoffeeScript 1.7.1
(function() {
  var Schema, models, models_dir, mongoose, tools, _;

  _ = require('lodash');

  mongoose = require('mongoose');

  Schema = mongoose.Schema;

  tools = require('./tools');

  models_dir = __dirname + '/models';

  models = {};

  module.exports = function(host, name) {
    var models_array, mongo_uri, schemas;
    schemas = {};
    models_array = tools.loadModules(models_dir);
    mongo_uri = 'mongodb://' + host + '/' + name;
    mongoose.connect(mongo_uri);
    _.each(models_array, function(model, index) {
      schemas[index] = new Schema(model.model);
      return models[index] = mongoose.model(index, schemas[index]);
    });
    return models;
  };

}).call(this);
